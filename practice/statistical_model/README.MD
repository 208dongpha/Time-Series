# Ph√¢n T√≠ch v√† D·ª± B√°o Doanh S·ªë B√°n L·∫ª b·∫±ng ARIMA v√† SARIMA

## üìã T·ªïng Quan D·ª± √Ån

D·ª± √°n n√†y th·ª±c hi·ªán ph√¢n t√≠ch v√† d·ª± b√°o chu·ªói th·ªùi gian doanh s·ªë b√°n l·∫ª h√†ng th√°ng s·ª≠ d·ª•ng c√°c m√¥ h√¨nh th·ªëng k√™ ARIMA (AutoRegressive Integrated Moving Average) v√† SARIMA (Seasonal ARIMA). M·ª•c ti√™u l√† so s√°nh hi·ªáu qu·∫£ gi·ªØa hai m√¥ h√¨nh trong vi·ªác d·ª± b√°o d·ªØ li·ªáu c√≥ xu h∆∞·ªõng tƒÉng tr∆∞·ªüng m·∫°nh v√† t√≠nh m√πa v·ª• r√µ r·ªát.

### K·∫øt Qu·∫£ T√≥m T·∫Øt

D·ª±a tr√™n d·ªØ li·ªáu ki·ªÉm th·ª≠, m√¥ h√¨nh **SARIMA** cho th·∫•y s·ª± v∆∞·ª£t tr·ªôi ho√†n to√†n:

- **Ch·ªâ s·ªë AIC**: Gi·∫£m t·ª´ **597.03** (ARIMA) xu·ªëng **279.03** (SARIMA) - gi·∫£m 53%
- **Sai s·ªë MAPE**: Gi·∫£m t·ª´ **21.51%** xu·ªëng c√≤n **11.55%** - gi·∫£m g·∫ßn 50%
- **RMSE**: Gi·∫£m t·ª´ **4.30** xu·ªëng **2.47** - gi·∫£m 43%
- **Kh·∫£ nƒÉng d·ª± b√°o**: SARIMA t√°i hi·ªán ƒë∆∞·ª£c c√°c bi·∫øn ƒë·ªông h√¨nh rƒÉng c∆∞a th·ª±c t·∫ø, trong khi ARIMA ch·ªâ d·ª± b√°o ƒë∆∞·ª£c xu h∆∞·ªõng ph·∫≥ng

---

## üõ†Ô∏è C√†i ƒê·∫∑t v√† Y√™u C·∫ßu

### Y√™u C·∫ßu H·ªá Th·ªëng

- Python 3.7+
- C√°c th∆∞ vi·ªán Python (xem `requirements.txt`)

### C√†i ƒê·∫∑t

```bash
pip install -r requirements.txt
```

### C√°c Th∆∞ Vi·ªán Ch√≠nh

- **statsmodels**: X√¢y d·ª±ng m√¥ h√¨nh ARIMA/SARIMA, ki·ªÉm ƒë·ªãnh ADF, v·∫Ω ACF/PACF
- **pandas**: X·ª≠ l√Ω v√† thao t√°c d·ªØ li·ªáu chu·ªói th·ªùi gian
- **numpy**: T√≠nh to√°n s·ªë h·ªçc v√† th·ªëng k√™
- **matplotlib**: V·∫Ω bi·ªÉu ƒë·ªì v√† tr·ª±c quan h√≥a k·∫øt qu·∫£

---

## üìÅ C·∫•u Tr√∫c D·ª± √Ån

```
statistical_model/
‚îú‚îÄ‚îÄ ARIMA_model.py              # File ch√≠nh ch·ª©a to√†n b·ªô pipeline
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ monthlyretailsales.csv  # D·ªØ li·ªáu ƒë·∫ßu v√†o
‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îî‚îÄ‚îÄ ARIMA_model/            # Th∆∞ m·ª•c ch·ª©a k·∫øt qu·∫£
‚îÇ       ‚îú‚îÄ‚îÄ *.png               # C√°c bi·ªÉu ƒë·ªì
‚îÇ       ‚îú‚îÄ‚îÄ *.log               # C√°c file log
‚îÇ       ‚îî‚îÄ‚îÄ *.txt               # C√°c b√°o c√°o ph√¢n t√≠ch
‚îî‚îÄ‚îÄ README.md                   # File n√†y
```

---

## üìñ Gi·∫£i Th√≠ch Code Chi Ti·∫øt

### 1. C·∫•u Tr√∫c T·ªïng Quan

File `ARIMA_model.py` ƒë∆∞·ª£c t·ªï ch·ª©c th√†nh c√°c module ch·ª©c nƒÉng r√µ r√†ng:

```python
# 1. PATH MANAGEMENT - Qu·∫£n l√Ω ƒë∆∞·ªùng d·∫´n
# 2. LOGGER - H·ªá th·ªëng ghi log
# 3. LOAD DATA - T·∫£i d·ªØ li·ªáu
# 4. PLOT - V·∫Ω bi·ªÉu ƒë·ªì
# 5. ADF - Ki·ªÉm ƒë·ªãnh t√≠nh d·ª´ng
# 6. TRANSFORM - Bi·∫øn ƒë·ªïi d·ªØ li·ªáu
# 7. SPLIT - Chia t·∫≠p train/test
# 8. ARIMA - X√¢y d·ª±ng m√¥ h√¨nh
# 9. RESIDUALS - Ch·∫©n ƒëo√°n ph·∫ßn d∆∞
# 10. FORECAST & EVAL - D·ª± b√°o v√† ƒë√°nh gi√°
# 11. MAIN - H√†m ƒëi·ªÅu khi·ªÉn ch√≠nh
```

### 2. Qu·∫£n L√Ω ƒê∆∞·ªùng D·∫´n (PATH MANAGEMENT)

```python
def get_base_dir() -> Path:
    """L·∫•y ƒë∆∞·ªùng d·∫´n th∆∞ m·ª•c g·ªëc ch·ª©a file script hi·ªán t·∫°i."""
    return Path(__file__).resolve().parent

def get_data_path() -> Path:
    """L·∫•y ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi ƒë·∫øn file d·ªØ li·ªáu CSV."""
    return get_base_dir() / "data" / "monthlyretailsales.csv"

def get_log_dir() -> Path:
    """T·ª± ƒë·ªông t·∫°o th∆∞ m·ª•c logs n·∫øu ch∆∞a t·ªìn t·∫°i."""
    log_dir = get_base_dir() / "logs" / "ARIMA_model"
    log_dir.mkdir(parents=True, exist_ok=True)
    return log_dir
```

**Gi·∫£i th√≠ch**: S·ª≠ d·ª•ng `pathlib.Path` ƒë·ªÉ qu·∫£n l√Ω ƒë∆∞·ªùng d·∫´n m·ªôt c√°ch an to√†n v√† t·ª± ƒë·ªông, tr√°nh l·ªói khi ch·∫°y t·ª´ c√°c th∆∞ m·ª•c kh√°c nhau.

### 3. H·ªá Th·ªëng Logger

Code s·ª≠ d·ª•ng 6 logger ri√™ng bi·ªát ƒë·ªÉ theo d√µi t·ª´ng kh√≠a c·∫°nh c·ªßa pipeline:

```python
main_logger   # Theo d√µi lu·ªìng th·ª±c thi ch√≠nh (m·ªói l·∫ßn ch·∫°y t·∫°o file ri√™ng)
lag_logger    # Ghi l·∫°i g·ª£i √Ω v·ªÅ b·∫≠c p v√† q t·ª´ ACF/PACF
adf_logger    # Chi ti·∫øt k·∫øt qu·∫£ ki·ªÉm ƒë·ªãnh t√≠nh d·ª´ng
ic_logger     # Ch·ªâ s·ªë AIC/BIC ƒë·ªÉ so s√°nh m√¥ h√¨nh
eval_logger   # K·∫øt qu·∫£ ƒë√°nh gi√° (MAE, RMSE, MAPE)
res_logger    # Ch·∫©n ƒëo√°n ph·∫ßn d∆∞ (residuals)
```

**L·ª£i √≠ch**: 
- D·ªÖ d√†ng debug v√† theo d√µi t·ª´ng b∆∞·ªõc
- L∆∞u tr·ªØ l·ªãch s·ª≠ c√°c l·∫ßn ch·∫°y
- Ph√¢n t√≠ch k·∫øt qu·∫£ m·ªôt c√°ch c√≥ h·ªá th·ªëng

### 4. T·∫£i v√† X·ª≠ L√Ω D·ªØ Li·ªáu

```python
def load_data() -> pd.Series:
    path = get_data_path()
    if not path.exists():
        raise FileNotFoundError(f"Dataset not found: {path}")
    
    df = pd.read_csv(path)
    df["date"] = pd.to_datetime(df["date"])
    df.set_index("date", inplace=True)
    ts = df.iloc[:, 0]
    ts = ts.asfreq("MS")  # Monthly Start frequency
    return ts
```

**Gi·∫£i th√≠ch**:
- ƒê·ªçc CSV v√† chuy·ªÉn c·ªôt `date` th√†nh index
- `asfreq("MS")` ƒë·∫£m b·∫£o t·∫ßn su·∫•t d·ªØ li·ªáu l√† h√†ng th√°ng (Monthly Start)
- Tr·∫£ v·ªÅ `pd.Series` v·ªõi index l√† datetime

### 5. Ki·ªÉm ƒê·ªãnh T√≠nh D·ª´ng (ADF Test)

```python
def adf_test(ts: pd.Series, d: int = 0):
    """Th·ª±c hi·ªán ki·ªÉm ƒë·ªãnh Augmented Dickey-Fuller."""
    stat, pval = adfuller(ts.dropna())[0:2]
    
    if pval < 0.05:
        adf_logger.info("Conclusion: Stationary")
    else:
        adf_logger.info("Conclusion: Non-stationary")
    
    return stat, pval
```

**Gi·∫£i th√≠ch**:
- **ADF Test** ki·ªÉm tra xem chu·ªói c√≥ t√≠nh d·ª´ng (stationary) hay kh√¥ng
- **H0**: Chu·ªói c√≥ unit root (kh√¥ng d·ª´ng)
- **H1**: Chu·ªói d·ª´ng
- N·∫øu `p-value < 0.05`: B√°c b·ªè H0 ‚Üí Chu·ªói d·ª´ng

**K·∫øt qu·∫£ t·ª´ log**:
```
d=0: p-value = 1.0 > 0.05 ‚Üí Kh√¥ng d·ª´ng
d=1: p-value = 0.117 > 0.05 ‚Üí Kh√¥ng d·ª´ng  
d=2: p-value = 3.54e-18 < 0.05 ‚Üí D·ª´ng ‚úì
```

### 6. Sai Ph√¢n (Differencing)

```python
def difference(ts: pd.Series, d: int = 1) -> pd.Series:
    """Th·ª±c hi·ªán l·∫•y sai ph√¢n b·∫≠c d ƒë·ªÉ lo·∫°i b·ªè xu h∆∞·ªõng."""
    temp_ts = ts.copy()
    for _ in range(d):
        temp_ts = temp_ts.diff().dropna()
    return temp_ts
```

**Gi·∫£i th√≠ch**:
- Sai ph√¢n b·∫≠c 1: `y_t = x_t - x_{t-1}`
- Sai ph√¢n b·∫≠c 2: √Åp d·ª•ng sai ph√¢n 2 l·∫ßn
- M·ª•c ƒë√≠ch: Lo·∫°i b·ªè xu h∆∞·ªõng (trend) ƒë·ªÉ ƒë·∫°t t√≠nh d·ª´ng

### 7. Ph√¢n T√≠ch ACF/PACF

```python
def suggest_arima_lags(ts: pd.Series, max_lag: int = 20, d_val: int = 1):
    """G·ª£i √Ω b·∫≠c p (AR) v√† q (MA) d·ª±a tr√™n ACF/PACF."""
    n = len(ts.dropna())
    conf = 1.96 / np.sqrt(n)  # Ng∆∞·ª°ng tin c·∫≠y 95%
    
    acf_vals = acf(ts.dropna(), nlags=max_lag)
    pacf_vals = pacf(ts.dropna(), nlags=max_lag)
    
    # T√¨m c√°c lag v∆∞·ª£t ng∆∞·ª°ng
    q_lags = [lag for lag, val in enumerate(acf_vals[1:], start=1) 
              if abs(val) > conf]
    p_lags = [lag for lag, val in enumerate(pacf_vals[1:], start=1) 
              if abs(val) > conf]
    
    return p_lags, q_lags
```

**Gi·∫£i th√≠ch**:
- **ACF (Autocorrelation Function)**: ƒêo t∆∞∆°ng quan gi·ªØa gi√° tr·ªã hi·ªán t·∫°i v√† c√°c gi√° tr·ªã qu√° kh·ª©
- **PACF (Partial Autocorrelation Function)**: ƒêo t∆∞∆°ng quan tr·ª±c ti·∫øp gi·ªØa `y_t` v√† `y_{t-k}` sau khi lo·∫°i b·ªè ·∫£nh h∆∞·ªüng c·ªßa c√°c lag trung gian
- **Ng∆∞·ª°ng tin c·∫≠y**: `¬±1.96/‚àön` cho kho·∫£ng tin c·∫≠y 95%
- **Quy t·∫Øc**:
  - **PACF c·∫Øt c·ª•t t·∫°i lag p** ‚Üí G·ª£i √Ω b·∫≠c AR = p
  - **ACF c·∫Øt c·ª•t t·∫°i lag q** ‚Üí G·ª£i √Ω b·∫≠c MA = q

**K·∫øt qu·∫£ t·ª´ log**:
```
Suggested p (AR) lags from PACF: [1, 2, 3, 4, 5, 6, 7, 10, 11, 12, 16]
Suggested q (MA) lags from ACF: [1, 2, 10, 11, 12, 13]
Recommended ARIMA candidates: [(1, 2, 1), (1, 2, 2), (2, 2, 1), (2, 2, 2)]
```

### 8. X√¢y D·ª±ng M√¥ H√¨nh ARIMA

```python
def fit_arima(train: pd.Series, order: tuple):
    """Hu·∫•n luy·ªán m√¥ h√¨nh ARIMA v·ªõi tham s·ªë (p, d, q)."""
    model = ARIMA(train, order=order)
    result = model.fit()
    
    ic_logger.info(f"ARIMA{order}")
    ic_logger.info(f"AIC: {result.aic:.4f}")
    ic_logger.info(f"BIC: {result.bic:.4f}")
    
    return result
```

**Gi·∫£i th√≠ch**:
- **ARIMA(p, d, q)**:
  - `p`: B·∫≠c t·ª± h·ªìi quy (AR)
  - `d`: B·∫≠c sai ph√¢n (I)
  - `q`: B·∫≠c trung b√¨nh tr∆∞·ª£t (MA)
- **AIC/BIC**: Ch·ªâ s·ªë so s√°nh m√¥ h√¨nh (c√†ng nh·ªè c√†ng t·ªët)

### 9. X√¢y D·ª±ng M√¥ H√¨nh SARIMA

```python
def fit_sarima(train: pd.Series, order: tuple, s_order: tuple):
    """Hu·∫•n luy·ªán m√¥ h√¨nh SARIMA v·ªõi th√†nh ph·∫ßn m√πa v·ª•."""
    model = ARIMA(train, order=order, seasonal_order=s_order)
    result = model.fit()
    return result
```

**Gi·∫£i th√≠ch**:
- **SARIMA(p, d, q)(P, D, Q, s)**:
  - `(p, d, q)`: Tham s·ªë cho th√†nh ph·∫ßn kh√¥ng m√πa v·ª•
  - `(P, D, Q, s)`: Tham s·ªë cho th√†nh ph·∫ßn m√πa v·ª•
  - `s`: Chu k·ª≥ m√πa v·ª• (12 cho d·ªØ li·ªáu h√†ng th√°ng)
- **∆Øu ƒëi·ªÉm**: X·ª≠ l√Ω ƒë∆∞·ª£c c·∫£ xu h∆∞·ªõng v√† t√≠nh m√πa v·ª•

### 10. Ch·∫©n ƒêo√°n Ph·∫ßn D∆∞ (Residual Diagnostics)

```python
def residual_diagnostics(residuals: pd.Series, order: tuple):
    """Ki·ªÉm tra ph·∫ßn d∆∞ c√≥ ph·∫£i l√† nhi·ªÖu tr·∫Øng kh√¥ng."""
    mean_res = residuals.mean()
    
    if abs(mean_res) < 0.01:
        res_logger.info("Residual mean approx 0 -> OK")
    else:
        res_logger.info("Residual mean != 0 -> CHECK")
    
    # V·∫Ω bi·ªÉu ƒë·ªì ph·∫ßn d∆∞ v√† ACF c·ªßa ph·∫ßn d∆∞
    plot_residuals(residuals, order)
    plot_residuals_acf(residuals, order)
```

**Gi·∫£i th√≠ch**:
- **Ph·∫ßn d∆∞ t·ªët** ph·∫£i c√≥:
  - Trung b√¨nh ‚âà 0
  - Kh√¥ng c√≥ t∆∞∆°ng quan (ACF c·ªßa ph·∫ßn d∆∞ n·∫±m trong ng∆∞·ª°ng tin c·∫≠y)
  - Ph√¢n ph·ªëi chu·∫©n
- N·∫øu ph·∫ßn d∆∞ kh√¥ng ph·∫£i nhi·ªÖu tr·∫Øng ‚Üí M√¥ h√¨nh ch∆∞a t·ªët, c·∫ßn ƒëi·ªÅu ch·ªânh

**K·∫øt qu·∫£ t·ª´ log**:
```
ARIMA(2, 2, 1): Residual mean = 0.086 ‚Üí CHECK (h∆°i cao)
SARIMA(1, 2, 1)x(1, 1, 1, 12): Residual mean = 0.010 ‚Üí OK ‚úì
```

### 11. D·ª± B√°o v√† ƒê√°nh Gi√°

```python
def forecast(model, steps: int) -> pd.Series:
    """D·ª± b√°o c√°c gi√° tr·ªã t∆∞∆°ng lai."""
    return model.forecast(steps=steps)

def evaluation(test: pd.Series, pred: pd.Series, model_name: str):
    """T√≠nh to√°n c√°c ch·ªâ s·ªë ƒë√°nh gi√°."""
    mae = np.mean(np.abs(test - pred))
    rmse = np.sqrt(np.mean((test - pred) ** 2))
    mape = np.mean(np.abs((test - pred) / test)) * 100
```

**Gi·∫£i th√≠ch c√°c ch·ªâ s·ªë**:
- **MAE (Mean Absolute Error)**: Sai s·ªë tuy·ªát ƒë·ªëi trung b√¨nh
- **RMSE (Root Mean Squared Error)**: CƒÉn b·∫≠c hai c·ªßa sai s·ªë b√¨nh ph∆∞∆°ng trung b√¨nh (nh·∫°y c·∫£m v·ªõi outlier)
- **MAPE (Mean Absolute Percentage Error)**: Sai s·ªë ph·∫ßn trƒÉm trung b√¨nh (d·ªÖ hi·ªÉu, kh√¥ng ph·ª• thu·ªôc ƒë∆°n v·ªã)

---

## üîç Ph√¢n T√≠ch K·∫øt Qu·∫£ ƒê·∫ßu Ra

### 1. File Log: `run_YYYYMMDD_HHMMSS.log`

File n√†y ghi l·∫°i to√†n b·ªô lu·ªìng th·ª±c thi c·ªßa pipeline:

```
2025-12-28 18:58:35 - === START ARIMA & SARIMA PIPELINE ===
2025-12-28 18:58:35 - Loading data from .../monthlyretailsales.csv
2025-12-28 18:58:36 - Saved figure: 01_original_series.png
2025-12-28 18:58:36 - Differencing with order d=1
2025-12-28 18:58:36 - p-value > 0.05, trying d=2...
2025-12-28 18:58:36 - Differencing with order d=2
2025-12-28 18:58:36 - Saved figure: 03_acf_pacf.png
2025-12-28 18:58:36 - Train size: 163, Test size: 41
2025-12-28 18:58:36 - Fitting ARIMA(2, 2, 1)
2025-12-28 18:58:37 - Fitting SARIMA(1, 2, 1)x(1, 1, 1, 12)
2025-12-28 18:58:38 - Generating diagnostics for ARIMA...
2025-12-28 18:58:39 - Forecasting 41 steps
2025-12-28 18:58:39 - ARIMA AIC: 597.03
2025-12-28 18:58:39 - SARIMA AIC: 279.03
2025-12-28 18:58:39 - === END PIPELINE ===
```

**Ph√¢n t√≠ch**: Pipeline ch·∫°y th√†nh c√¥ng, t·ª± ƒë·ªông ph√°t hi·ªán c·∫ßn sai ph√¢n b·∫≠c 2, v√† chia d·ªØ li·ªáu 80/20 cho train/test.

### 2. File Log: `adf.log`

K·∫øt qu·∫£ ki·ªÉm ƒë·ªãnh t√≠nh d·ª´ng:

```
--- ADF Test for d=0 ---
ADF Statistic: 3.1452
p-value: 1.0
Conclusion: Non-stationary

--- ADF Test for d=1 ---
ADF Statistic: -2.4952
p-value: 0.1167
Conclusion: Non-stationary

--- ADF Test for d=2 ---
ADF Statistic: -10.2923
p-value: 3.54e-18
Conclusion: Stationary ‚úì
```

**Ph√¢n t√≠ch**:
- Chu·ªói g·ªëc v√† sai ph√¢n b·∫≠c 1 ƒë·ªÅu **kh√¥ng d·ª´ng** (p-value > 0.05)
- Ch·ªâ sau khi sai ph√¢n b·∫≠c 2, chu·ªói m·ªõi ƒë·∫°t t√≠nh d·ª´ng (p-value c·ª±c nh·ªè)
- **Quy·∫øt ƒë·ªãnh**: S·ª≠ d·ª•ng `d = 2` cho m√¥ h√¨nh ARIMA

### 3. File Log: `suggested_lags.log`

G·ª£i √Ω v·ªÅ b·∫≠c p v√† q:

```
=== SUGGESTED ARIMA LAGS ===
Sample size (N): 202
Confidence threshold: ¬±0.1379

Suggested p (AR) lags from PACF: [1, 2, 3, 4, 5, 6, 7, 10, 11, 12, 16]
Suggested q (MA) lags from ACF: [1, 2, 10, 11, 12, 13]

Recommended ARIMA candidates: [(1, 2, 1), (1, 2, 2), (2, 2, 1), (2, 2, 2)]
```

**Ph√¢n t√≠ch**:
- Nhi·ªÅu lag v∆∞·ª£t ng∆∞·ª°ng, nh∆∞ng th∆∞·ªùng ch·ªçn lag ƒë·∫ßu ti√™n ho·∫∑c v√†i lag ƒë·∫ßu
- Code ch·ªçn 2 lag ƒë·∫ßu ti√™n: `p_suggest = [1, 2]`, `q_suggest = [1, 2]`
- T·∫°o ra 4 ·ª©ng vi√™n: `(1,2,1)`, `(1,2,2)`, `(2,2,1)`, `(2,2,2)`
- **L∆∞u √Ω**: Lag 12 xu·∫•t hi·ªán trong c·∫£ ACF v√† PACF ‚Üí G·ª£i √Ω m·∫°nh v·ªÅ t√≠nh m√πa v·ª• (s=12)

### 4. File Log: `information_criteria.log`

So s√°nh AIC/BIC gi·ªØa c√°c m√¥ h√¨nh:

```
ARIMA(2, 2, 1)
AIC: 597.0252
BIC: 609.3508

SARIMA(1, 2, 1)x(1, 1, 1, 12)
AIC: 279.03
BIC: 294.05
```

**Ph√¢n t√≠ch**:
- **AIC c·ªßa SARIMA th·∫•p h∆°n 53%** so v·ªõi ARIMA ‚Üí SARIMA ph√π h·ª£p h∆°n r·∫•t nhi·ªÅu
- **BIC c≈©ng th·∫•p h∆°n ƒë√°ng k·ªÉ** ‚Üí X√°c nh·∫≠n SARIMA l√† m√¥ h√¨nh t·ªët h∆°n
- **K·∫øt lu·∫≠n**: SARIMA gi·∫£i th√≠ch ƒë∆∞·ª£c nhi·ªÅu bi·∫øn thi√™n h∆°n v·ªõi c√πng s·ªë tham s·ªë (ho·∫∑c √≠t tham s·ªë h∆°n)

### 5. File Log: `residuals.log`

Ch·∫©n ƒëo√°n ph·∫ßn d∆∞:

```
Residual diagnostics ARIMA(2, 2, 1)
Residual mean: 0.086271
Residual mean != 0 -> CHECK

Residual diagnostics SARIMA(1, 2, 1, 12)
Residual mean: 0.009902
Residual mean approx 0 -> OK ‚úì
```

**Ph√¢n t√≠ch**:
- **ARIMA**: Trung b√¨nh ph·∫ßn d∆∞ = 0.086 (h∆°i cao) ‚Üí C√≥ th·ªÉ c√≤n bias
- **SARIMA**: Trung b√¨nh ph·∫ßn d∆∞ = 0.010 (r·∫•t g·∫ßn 0) ‚Üí Ph·∫ßn d∆∞ t·ªët h∆°n
- **K·∫øt lu·∫≠n**: SARIMA c√≥ ph·∫ßn d∆∞ g·∫ßn v·ªõi nhi·ªÖu tr·∫Øng h∆°n

### 6. File Log: `evaluation.log`

K·∫øt qu·∫£ ƒë√°nh gi√° tr√™n t·∫≠p test:

```
=== Evaluation for: ARIMA(2, 2, 1) ===
MAE: 3.636
RMSE: 4.300
MAPE: 21.51%

=== Evaluation for: SARIMA(1, 1, 1)x(1, 1, 1, 12) ===
MAE: 1.995
RMSE: 2.466
MAPE: 11.55%
```

**Ph√¢n t√≠ch**:
- **MAE**: SARIMA gi·∫£m 45% (t·ª´ 3.64 ‚Üí 1.99)
- **RMSE**: SARIMA gi·∫£m 43% (t·ª´ 4.30 ‚Üí 2.47)
- **MAPE**: SARIMA gi·∫£m 46% (t·ª´ 21.51% ‚Üí 11.55%)
- **K·∫øt lu·∫≠n**: SARIMA d·ª± b√°o ch√≠nh x√°c h∆°n ƒë√°ng k·ªÉ tr√™n m·ªçi ch·ªâ s·ªë

### 7. File B√°o C√°o: `stationarity_test_YYYYMMDD_HHMMSS.txt`

B√°o c√°o chi ti·∫øt v·ªÅ ki·ªÉm ƒë·ªãnh t√≠nh d·ª´ng:

```
Stationarity Test Results (Augmented Dickey-Fuller Test)
============================================================
Original data length: 204
Date range: 1991-07-01 to 2008-06-01

Differencing Order d = 0 (Original):
  ADF Statistic: 3.1452
  p-value: 1.0000
  Stationary: No (p-value >= 0.05)

Differencing Order d = 1:
  ADF Statistic: -2.4952
  p-value: 0.1167
  Stationary: No (p-value >= 0.05)

Differencing Order d = 2:
  ADF Statistic: -10.2923
  p-value: 0.0000
  Stationary: Yes (p-value < 0.05) ‚úì

Suggested Differencing Order (d): 2
```

**Ph√¢n t√≠ch**: B√°o c√°o n√†y cung c·∫•p ƒë·∫ßy ƒë·ªß th√¥ng tin v·ªÅ qu√° tr√¨nh ki·ªÉm ƒë·ªãnh, gi√∫p ng∆∞·ªùi ƒë·ªçc hi·ªÉu r√µ l√Ω do ch·ªçn `d=2`.

### 8. File B√°o C√°o: `ACF_PACF_Analysis_YYYYMMDD_HHMMSS.txt`

B√°o c√°o ph√¢n t√≠ch ACF/PACF:

```
ACF and PACF Analysis for ARIMA Model Selection
============================================================
Data length: 202
Confidence Interval Thresholds:
  90% CI threshold: ¬±0.1157
  95% CI threshold: ¬±0.1379 (used for analysis)
  99% CI threshold: ¬±0.1812

Significant PACF lags (|PACF| > 0.1379) - for AR order:
  Lag 1: -0.6346
  Lag 2: -0.3673
  Lag 3: -0.3032
  ...

Significant ACF lags (|ACF| > 0.1379) - for MA order:
  Lag 1: -0.6346
  Lag 2: -0.3673
  ...

Suggested ARIMA order: AR(2), I(2), MA(1)
```

**Ph√¢n t√≠ch**: 
- Gi·∫£i th√≠ch r√µ c√°ch t√≠nh ng∆∞·ª°ng tin c·∫≠y d·ª±a tr√™n Z-score
- Li·ªát k√™ t·∫•t c·∫£ c√°c lag c√≥ √Ω nghƒ©a th·ªëng k√™
- ƒê∆∞a ra g·ª£i √Ω c·ª• th·ªÉ v·ªÅ b·∫≠c m√¥ h√¨nh

### 9. File B√°o C√°o: `z_table_YYYYMMDD_HHMMSS.txt`

B·∫£ng tra c·ª©u Z-score v√† gi·∫£i th√≠ch c∆° s·ªü to√°n h·ªçc:

```
STANDARD NORMAL DISTRIBUTION (Z-TABLE)
Critical Values for ACF / PACF Confidence Intervals
================================================================================

Statistical assumption:
Under the null hypothesis of no autocorrelation,
sample ACF and PACF values are approximately distributed as:
  N(0, 1 / ‚àön)

Confidence interval formula:
  CI = ¬± z_(Œ±/2) / ‚àön

COMMONLY USED CONFIDENCE LEVELS
Confidence Level      Two-Tailed Œ±      Z-Score (zŒ±/2)
--------------------------------------------------------------------------------
  90.0%                0.100            1.6449
  95.0%                0.050            1.9600
  99.0%                0.010            2.5758

APPLICATION TO YOUR DATASET
Sample size (n): 204

Calculated confidence thresholds:
  90% CI  : ¬±0.1157   (z = 1.645)
  95% CI  : ¬±0.1379   (z = 1.96)  ‚Üê used for analysis
  99% CI  : ¬±0.1812   (z = 2.576)
```

**Ph√¢n t√≠ch**: File n√†y gi·∫£i th√≠ch c∆° s·ªü to√°n h·ªçc ƒë·∫±ng sau vi·ªác ch·ªçn ng∆∞·ª°ng tin c·∫≠y, gi√∫p ng∆∞·ªùi ƒë·ªçc hi·ªÉu t·∫°i sao s·ª≠ d·ª•ng gi√° tr·ªã `¬±0.1379` cho ph√¢n t√≠ch.

---

## üìä Ph√¢n T√≠ch H√¨nh ·∫¢nh ƒê·∫ßu Ra

### 1. `01_original_series.png`

**M√¥ t·∫£**: Bi·ªÉu ƒë·ªì chu·ªói th·ªùi gian g·ªëc

**Ph√¢n t√≠ch**:
- Cho th·∫•y xu h∆∞·ªõng tƒÉng tr∆∞·ªüng m·∫°nh theo th·ªùi gian
- C√≥ t√≠nh m√πa v·ª• r√µ r·ªát (bi·∫øn ƒë·ªông l√™n xu·ªëng theo chu k·ª≥)
- D·ªØ li·ªáu kh√¥ng d·ª´ng (c·∫ßn sai ph√¢n)

### 2. `03_acf_pacf.png`

**M√¥ t·∫£**: Bi·ªÉu ƒë·ªì ACF v√† PACF c·ªßa chu·ªói sau khi sai ph√¢n b·∫≠c 2

**Ph√¢n t√≠ch**:
- **ACF**: 
  - Lag 1 c√≥ gi√° tr·ªã cao (‚âà -0.63)
  - C√≥ ƒë·ªânh t·∫°i lag 12 ‚Üí G·ª£i √Ω m·∫°nh v·ªÅ t√≠nh m√πa v·ª•
- **PACF**:
  - Lag 1 v√† 2 v∆∞·ª£t ng∆∞·ª°ng ‚Üí G·ª£i √Ω AR(2)
  - C≈©ng c√≥ ƒë·ªânh t·∫°i lag 12
- **K·∫øt lu·∫≠n**: C·∫ßn m√¥ h√¨nh c√≥ th√†nh ph·∫ßn m√πa v·ª• (SARIMA)

### 3. `04_residuals_(2, 2, 1).png` v√† `04_residuals_(1, 2, 1, 12).png`

**M√¥ t·∫£**: Bi·ªÉu ƒë·ªì ph·∫ßn d∆∞ c·ªßa ARIMA v√† SARIMA

**Ph√¢n t√≠ch**:
- **ARIMA**: Ph·∫ßn d∆∞ c√≥ v·∫ª c√≤n m·ªôt s·ªë pattern (kh√¥ng ho√†n to√†n ng·∫´u nhi√™n)
- **SARIMA**: Ph·∫ßn d∆∞ tr√¥ng ng·∫´u nhi√™n h∆°n, ph√¢n t√°n ƒë·ªÅu quanh 0
- **K·∫øt lu·∫≠n**: SARIMA c√≥ ph·∫ßn d∆∞ t·ªët h∆°n

### 4. `05_residuals_acf_(2, 2, 1).png` v√† `05_residuals_acf_(1, 2, 1, 12).png`

**M√¥ t·∫£**: ACF c·ªßa ph·∫ßn d∆∞

**Ph√¢n t√≠ch**:
- **L√Ω t∆∞·ªüng**: T·∫•t c·∫£ c√°c lag n·∫±m trong ng∆∞·ª°ng tin c·∫≠y (v√πng xanh)
- **ARIMA**: C√≥ th·ªÉ c√≤n m·ªôt s·ªë lag v∆∞·ª£t ng∆∞·ª°ng
- **SARIMA**: H·∫ßu h·∫øt lag n·∫±m trong ng∆∞·ª°ng ‚Üí Ph·∫ßn d∆∞ g·∫ßn v·ªõi nhi·ªÖu tr·∫Øng

### 5. `07_comparison_forecast.png`

**M√¥ t·∫£**: So s√°nh d·ª± b√°o gi·ªØa ARIMA v√† SARIMA v·ªõi d·ªØ li·ªáu th·ª±c t·∫ø

**Ph√¢n t√≠ch**:
- **ARIMA (ƒë∆∞·ªùng ƒë·ªè n√©t ƒë·ª©t)**: 
  - Ch·ªâ d·ª± b√°o ƒë∆∞·ª£c xu h∆∞·ªõng ph·∫≥ng
  - Kh√¥ng b·∫Øt ƒë∆∞·ª£c c√°c bi·∫øn ƒë·ªông m√πa v·ª•
  - Sai s·ªë l·ªõn t·∫°i c√°c ƒëi·ªÉm c√≥ bi·∫øn ƒë·ªông m·∫°nh
  
- **SARIMA (ƒë∆∞·ªùng xanh l√°)**:
  - T√°i hi·ªán ƒë∆∞·ª£c c√°c bi·∫øn ƒë·ªông h√¨nh rƒÉng c∆∞a
  - B·∫Øt ƒë∆∞·ª£c c·∫£ xu h∆∞·ªõng v√† t√≠nh m√πa v·ª•
  - S√°t v·ªõi d·ªØ li·ªáu th·ª±c t·∫ø (ƒë∆∞·ªùng cam) h∆°n nhi·ªÅu

- **K·∫øt lu·∫≠n**: SARIMA v∆∞·ª£t tr·ªôi ho√†n to√†n trong vi·ªác d·ª± b√°o d·ªØ li·ªáu c√≥ t√≠nh m√πa v·ª•

---

## üöÄ H∆∞·ªõng D·∫´n S·ª≠ D·ª•ng

### Ch·∫°y Pipeline

```bash
python ARIMA_model.py
```

### K·∫øt Qu·∫£ ƒê·∫ßu Ra

Sau khi ch·∫°y, b·∫°n s·∫Ω c√≥:

1. **C√°c file log** trong `logs/ARIMA_model/`:
   - `run_YYYYMMDD_HHMMSS.log`: Log t·ªïng quan
   - `adf.log`: K·∫øt qu·∫£ ki·ªÉm ƒë·ªãnh t√≠nh d·ª´ng
   - `suggested_lags.log`: G·ª£i √Ω b·∫≠c p, q
   - `information_criteria.log`: AIC/BIC
   - `evaluation.log`: MAE, RMSE, MAPE
   - `residuals.log`: Ch·∫©n ƒëo√°n ph·∫ßn d∆∞

2. **C√°c file b√°o c√°o** (`.txt`):
   - `stationarity_test_*.txt`: B√°o c√°o chi ti·∫øt v·ªÅ t√≠nh d·ª´ng
   - `ACF_PACF_Analysis_*.txt`: Ph√¢n t√≠ch ACF/PACF
   - `z_table_*.txt`: B·∫£ng tra c·ª©u Z-score

3. **C√°c bi·ªÉu ƒë·ªì** (`.png`):
   - `01_original_series.png`: Chu·ªói g·ªëc
   - `03_acf_pacf.png`: ACF/PACF
   - `04_residuals_*.png`: Ph·∫ßn d∆∞
   - `05_residuals_acf_*.png`: ACF c·ªßa ph·∫ßn d∆∞
   - `07_comparison_forecast.png`: So s√°nh d·ª± b√°o

### T√πy Ch·ªânh Tham S·ªë

B·∫°n c√≥ th·ªÉ ch·ªânh s·ª≠a c√°c tham s·ªë trong h√†m `main()`:

```python
# Thay ƒë·ªïi t·ª∑ l·ªá train/test
train, test = split(ts, ratio=0.8)  # M·∫∑c ƒë·ªãnh 80/20

# Thay ƒë·ªïi tham s·ªë ARIMA
arima_order = (2, d_final, 1)  # (p, d, q)

# Thay ƒë·ªïi tham s·ªë SARIMA
seasonal_order = (1, 1, 1, 12)  # (P, D, Q, s)
```

---

## üìù K·∫øt Lu·∫≠n

### So S√°nh ARIMA vs SARIMA

| Ch·ªâ S·ªë | ARIMA(2,2,1) | SARIMA(1,2,1)x(1,1,1,12) | C·∫£i Thi·ªán |
|--------|--------------|--------------------------|-----------|
| **AIC** | 597.03 | 279.03 | ‚Üì 53% |
| **BIC** | 609.35 | 294.05 | ‚Üì 52% |
| **MAE** | 3.64 | 1.99 | ‚Üì 45% |
| **RMSE** | 4.30 | 2.47 | ‚Üì 43% |
| **MAPE** | 21.51% | 11.55% | ‚Üì 46% |
| **Residual Mean** | 0.086 | 0.010 | ‚Üì 88% |

### K·∫øt Lu·∫≠n Ch√≠nh

1. **SARIMA v∆∞·ª£t tr·ªôi ho√†n to√†n** trong vi·ªác d·ª± b√°o d·ªØ li·ªáu c√≥ t√≠nh m√πa v·ª•
2. **T√≠nh m√πa v·ª• l√† y·∫øu t·ªë quan tr·ªçng** - ARIMA kh√¥ng th·ªÉ b·∫Øt ƒë∆∞·ª£c pattern n√†y
3. **Ph·∫ßn d∆∞ c·ªßa SARIMA t·ªët h∆°n** - g·∫ßn v·ªõi nhi·ªÖu tr·∫Øng h∆°n
4. **M√¥ h√¨nh SARIMA ph√π h·ª£p h∆°n** cho d·ªØ li·ªáu doanh s·ªë b√°n l·∫ª h√†ng th√°ng

### Khuy·∫øn Ngh·ªã

- **S·ª≠ d·ª•ng SARIMA** cho d·ªØ li·ªáu c√≥ t√≠nh m√πa v·ª• r√µ r·ªát
- **Ki·ªÉm tra ph·∫ßn d∆∞** ƒë·ªÉ ƒë·∫£m b·∫£o m√¥ h√¨nh ph√π h·ª£p
- **So s√°nh AIC/BIC** gi·ªØa c√°c m√¥ h√¨nh ƒë·ªÉ l·ª±a ch·ªçn t·ªët nh·∫•t
- **ƒê√°nh gi√° tr√™n t·∫≠p test** ƒë·ªÉ ki·ªÉm tra kh·∫£ nƒÉng d·ª± b√°o th·ª±c t·∫ø
